<div class="skill-check-dialog">
    <!-- Header Section (matching roll window style exactly) -->
    <div class="cpb-dialog-header-sticky">
        <div class="cpb-dialog-header">
            <div class="cpb-dialog-header-content">
                <div class="cpb-dialog-dice-icon">
                    <i class="fas fa-dice-d20"></i>
                </div>
                <div class="cpb-dialog-title-section">
                    <div class="cpb-dialog-main-title">Checks and Saves</div>
                    <div class="cpb-dialog-subtitle">Skill Checks • Ability Checks • Saving Throws</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="cpb-dialog-content">
        <!-- Left Column -->
        <div class="cpb-dialog-column">
            <h2><i class="fas fa-helmet-battle"></i> Contestants</h2>
            <div class="cpb-form-group">
                <div class="cpb-form-fields cpb-search-container">
                    <input type="text" name="search" placeholder="Search for contestants...">
                    <button type="button" class="cpb-clear-search-button" title="Clear search">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="cpb-filter-buttons">
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'canvas')}}active{{/if}}" data-filter="canvas">
                    <i class="fas fa-user-group-crown"></i> Canvas
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'party')}}active{{/if}}" data-filter="party">
                    <i class="fas fa-helmet-battle"></i> Party
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'monster')}}active{{/if}}" data-filter="monster">
                    <i class="fas fa-dragon"></i> NPCs
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'selected')}}active{{/if}}" data-filter="selected">
                    <i class="fas fa-square-dashed"></i> Selected
                </button>
            </div>
            <div class="cpb-actor-list">
                {{#each actors}}
                    <div class="cpb-actor-item" data-token-id="{{this.id}}">
                        <img src="{{this.actor.img}}" alt="{{this.name}}">
                        <div class="cpb-actor-details">
                            <div class="cpb-actor-name">{{this.name}}</div>
                            {{#if (eq this.type "character")}}
                                <div class="cpb-actor-info">Level {{this.level}} {{this.class}}</div>
                            {{else}}
                                <div class="cpb-actor-info">{{this.type}}</div>
                            {{/if}}
                            <div class="cpb-actor-info">HP: {{this.hp.value}}/{{this.hp.max}}</div>
                        </div>
                        <div class="cpb-group-indicator"></div>
                    </div>
                {{/each}}
            </div>
            <h3>Left-click to select. Right-click if a Defender.</h3>
        </div>

        <!-- Middle Column -->
        <div class="cpb-dialog-column">
            <h2><i class="fas fas fa-dice"></i> Roll Type</h2>
            
            <div class="cpb-form-group">
                <div class="cpb-form-fields cpb-search-container">
                    <input type="text" name="search" placeholder="Find roll type...">
                    <button type="button" class="cpb-clear-search-button" title="Clear search">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="cpb-filter-buttons">
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'quick')}}active{{/if}}" data-filter="quick">
                    Quick
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'skill')}}active{{/if}}" data-filter="skill">
                    Skill
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'ability')}}active{{/if}}" data-filter="ability">
                    Ability
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'save')}}active{{/if}}" data-filter="save">
                    Save
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'dice')}}active{{/if}}" data-filter="dice">
                    Dice
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'tool')}}active{{/if}}" data-filter="tool">
                    Tool
                </button>
            </div>
            <div class="cpb-checks-list">
                <!-- Quick Roll Section -->
                <div class="cpb-check-section" data-filter="quick">
                    <div class="cpb-section-header">Quick ROLLS</div>
                    <div class="cpb-section-subheader">Party Rolls (Auto-selects Party)</div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="party" data-value="perception" data-group="true" data-roll-title="Party Perception">
                        <i class="fas fa-magnifying-glass-waveform" title="Party Perception"></i>
                        <span class="cpb-roll-label">Party Perception</span><span class="cpb-roll-description">xxx</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="party" data-value="insight" data-group="true" data-roll-title="Party Insight">
                        <i class="fas fa-brain" title="Party Insight"></i>
                        <span class="cpb-roll-label">Party Insight</span><span class="cpb-roll-description">xxx</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="party" data-value="investigation" data-group="true" data-roll-title="Party Investigation">
                        <i class="fas fa-magnifying-glass" title="Party Investigation"></i> 
                        <span class="cpb-roll-label">Party Investigation</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="party" data-value="nature" data-group="true" data-roll-title="Party Nature">
                        <i class="fas fa-sheep" title="Party Nature"></i>
                        <span class="cpb-roll-label">Party Nature</span><span class="cpb-roll-description">xxx</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="party" data-value="stealth" data-group="true" data-roll-title="Party Stealth">
                        <i class="fas fa-burst" title="Party Stealth"></i> 
                        <span class="cpb-roll-label">Party Stealth</span><span class="cpb-roll-description">xxx</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div> 
                    </div>
                    <div class="cpb-section-subheader">COMMON ROLLS</div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="individual" data-value="perception" data-dc="10" data-group="true" data-roll-title="Perception Check">
                        <i class="fas fa-magnifying-glass-waveform" title="DC 15 Group Perception"></i>
                        <span class="cpb-roll-label">Perception Check</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="individual" data-value="perception" data-dc="15" data-group="true" data-roll-title="Perception Check">
                        <i class="fas fa-magnifying-glass-waveform" title="DC 15 Group Perception"></i>
                        <span class="cpb-roll-label">Perception Check</span><span class="cpb-roll-description">DC 15</span>
                    <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>

                    <div class="cpb-check-item" data-type="quick" data-roll-type="individual" data-value="insight" data-dc="10" data-group="true" data-roll-title="Insight Check">
                        <i class="fas fa-magnifying-glass-waveform" title="DC 10 Group Insight"></i>
                        <span class="cpb-roll-label">Insight Check</span><span class="cpb-roll-description">DC 10</span>
                    <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>

                    <div class="cpb-check-item" data-type="quick" data-roll-type="individual" data-value="insight" data-dc="15" data-group="true" data-roll-title="Insight Check">
                        <i class="fas fa-magnifying-glass-waveform" title="DC 15 Group Insight"></i>
                        <span class="cpb-roll-label">Insight Check</span><span class="cpb-roll-description">DC 15</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>

                    <div class="cpb-check-item" data-type="quick" data-roll-type="individual" data-value="investigation" data-dc="10" data-group="true" data-roll-title="Investigation Check">
                        <i class="fas fa-magnifying-glass-waveform" title="DC 10 Group Investigation"></i>
                        <span class="cpb-roll-label">Investigation Check</span><span class="cpb-roll-description">DC 10</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>

                    <div class="cpb-check-item" data-type="quick" data-roll-type="individual" data-value="investigation" data-dc="15" data-group="true" data-roll-title="Investigation Check">
                        <i class="fas fa-magnifying-glass-waveform" title="DC 15 Group Investigation"></i>
                        <span class="cpb-roll-label">Investigation Check</span><span class="cpb-roll-description">DC 15</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    
                    <div class="cpb-section-subheader">GRAPPLE ROLLS</div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="athletics" data-defender-skill="athletics" data-roll-title="Grapple Attack">
                        <i class="fas fa-hand-back-fist" title="Grapple Attack"></i> 
                        <span class="cpb-roll-label">Grapple Attack</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="athletics" data-defender-skill="acrobatics" data-roll-title="Grapple vs Acrobatics">
                        <i class="fas fa-person-running" title="Grapple vs Acrobatics"></i> 
                        <span class="cpb-roll-label">Grapple vs Acrobatics</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="athletics" data-defender-skill="athletics" data-roll-title="Shove Attack">
                        <i class="fas fa-arrows-up-down-left-right" title="Shove Attack"></i> 
                        <span class="cpb-roll-label">Shove Attack</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="athletics" data-defender-skill="athletics" data-roll-title="Escape Grapple">
                        <i class="fas fa-person-walking-dashed-line-arrow-right" title="Escape Grapple"></i> 
                        <span class="cpb-roll-label">Escape Grapple</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    
                    <div class="cpb-section-subheader">MANIPULATION ROLLS</div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="deception" data-defender-skill="insight" data-roll-title="Deception vs Insight">
                        <i class="fas fa-mask" title="Deception vs Insight"></i> 
                        <span class="cpb-roll-label">Deception vs Insight</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="persuasion" data-defender-skill="insight" data-roll-title="Persuasion vs Insight">
                        <i class="fas fa-comments" title="Persuasion vs Insight"></i> 
                        <span class="cpb-roll-label">Persuasion vs Insight</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="intimidation" data-defender-skill="insight" data-roll-title="Intimidation vs Insight">
                        <i class="fas fa-angry" title="Intimidation vs Insight"></i> 
                        <span class="cpb-roll-label">Intimidation vs Insight</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                    
                    <div class="cpb-section-subheader">STEALTH ROLLS</div>
                    <div class="cpb-check-item" data-type="quick" data-roll-type="contested" data-value="stealth" data-defender-skill="perception" data-roll-title="Stealth vs Perception">
                        <i class="fas fa-user-ninja" title="Stealth vs Perception"></i> 
                        <span class="cpb-roll-label">Stealth vs Perception</span><span class="cpb-roll-description">XXX</span>
                        <div class="cpb-roll-type-auto"><i class="fas fa-play"></i></div>
                    </div>
                </div>

                <!-- Skill Check Section -->
                <div class="cpb-check-section" data-filter="skill">
                    <div class="cpb-section-header">Skill Check</div>
                    {{#each skills}}
                    <div class="cpb-check-item" data-type="skill" data-value="{{this.id}}"  data-roll-title="{{this.name}} Skill Check" data-tooltip="{{this.description}}">
                        <i class="{{this.icon}}"></i>
                        <span class="cpb-roll-label">{{this.name}}</span><span class="cpb-roll-description">{{this.description}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>

                <!-- Ability Check Section -->
                <div class="cpb-check-section" data-filter="ability">
                    <div class="cpb-section-header">Ability Check</div>
                    {{#each abilities}}
                    <div class="cpb-check-item" data-type="ability" data-value="{{this.id}}" data-roll-title="{{this.name}} Ability Check" data-tooltip="{{this.description}}">
                        <i class="fas fa-user-circle"></i>
                        <span class="cpb-roll-label">{{this.name}}</span><span class="cpb-roll-description">{{this.description}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>

                <!-- Saving Throw Section -->
                <div class="cpb-check-section" data-filter="save">
                    <div class="cpb-section-header">Saving Throw</div>
                    {{#each saves}}
                    <div class="cpb-check-item" data-type="save" data-value="{{this.id}}"  data-roll-title="{{this.name}} Saving Throw" data-tooltip="{{this.description}}">
                        <i class="fas fa-shield-heart"></i>
                        <span class="cpb-roll-label">{{this.name}}</span><span class="cpb-roll-description">{{this.description}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>

                <!-- Dice Roll Section -->
                <div class="cpb-check-section" data-filter="dice">
                    <div class="cpb-section-header">Dice Roll</div>
                    <div class="cpb-dice-grid">
                        <div class="cpb-check-item" data-type="dice" data-value="d2" data-roll-title="1d2 Dice Roll">
                            <i class="fas fa-coin" title="d2"></i> 1d2
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d4" data-roll-title="1d4 Dice Roll">
                            <i class="fas fa-dice-d4" title="d4"></i> 1d4
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                    </div>
                    <div class="cpb-dice-grid">
                        <div class="cpb-check-item" data-type="dice" data-value="d6" data-roll-title="1d6 Dice Roll">
                            <i class="fas fa-dice-d6" title="d6"></i> 1d6
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d8" data-roll-title="1d8 Dice Roll">
                            <i class="fas fa-dice-d8" title="d8"></i> 1d8
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                    </div>
                    <div class="cpb-dice-grid">
                        <div class="cpb-check-item" data-type="dice" data-value="d10" data-roll-title="1d10 Dice Roll">
                            <i class="fas fa-dice-d10" title="d10"></i> 1d10
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d12" data-roll-title="1d12 Dice Roll">
                            <i class="fas fa-dice-d12" title="d12"></i> 1d12
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                    </div>
                    <div class="cpb-dice-grid">
                        <div class="cpb-check-item" data-type="dice" data-value="d20" data-roll-title="1d20 Dice Roll">
                            <i class="fas fa-dice-d20" title="d20"></i> 1d20
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d100" data-roll-title="1d100 Dice Roll">
                            <i class="fas fa-hundred-points" title="d100"></i> 1d100
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                    </div>
                </div>

                <!-- Tool Check Section -->
                <div class="cpb-check-section" data-filter="tool">
                    <div class="cpb-section-header">Tool Check</div>
                    {{#each tools}}
                    <div class="cpb-check-item{{#unless isCommon}} cpb-tool-unavailable{{/unless}}" data-type="tool" data-value="{{id}}" data-common="{{isCommon}}" data-roll-title="{{name}}"  data-tooltip="{{this.description}}">
                        <i class="fas fa-tools"></i>
                        <span class="cpb-roll-label">{{this.name}}</span><span class="cpb-roll-description">{{this.description}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>
            </div>
            <h3>Right-click to set a different defender type.</h3>
        </div>

        <!-- Right Column -->
        <div class="cpb-dialog-column">
            <h2><i class="fas fa-cog"></i> Roll Configuration</h2>
            <div class="cpb-form-group">
                <div class="cpb-form-fields">
                    <select name="rollMode">
                        <option value="roll">Public Roll</option>
                        <option value="gmroll">Private Roll</option>
                        <option value="blindroll">GM Only</option>
                    </select>
                </div>
            </div>
            
            <div class="cpb-roll-options-column">

                <div class="cpb-section-header">Difficulty Class</div>

                <div class="cpb-form-group">
                    <div class="cpb-form-fields">
                        <input type="number" name="dc" placeholder="Optional DC... e.g. 13 or 15">
                    </div>
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="showDC" {{#if userPreferences.showDC}}checked{{/if}}> Show the DC to the players
                        </label>
                    </div>
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="groupRoll" {{#if userPreferences.groupRoll}}checked{{/if}}> Evaluate Group DC
                        </label>
                    </div>
                </div>

                <div class="cpb-section-header">Additional Context</div>

                <div class="cpb-form-group">
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="showRollExplanation" {{#if userPreferences.showRollExplanation}}checked{{/if}}> Show Roll Type Details
                        </label>
                    </div>
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="showRollExplanationLink" {{#if userPreferences.showRollExplanationLink}}checked{{/if}}> Show Link to SRD
                        </label>
                    </div>
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="isCinematic" {{#if userPreferences.isCinematic}}checked{{/if}}> Cinematic Mode
                        </label>
                    </div>
                </div>
            </div>
            <h3>Contested roll overrides group settings.</h3>
        </div>
    </div>
    <!-- BUTTONS -->
    <div class="cpb-dialog-buttons">
        <button class="cpb-dialog-button button-cancel" data-button="cancel">
            <i class="fas fa-times"></i>
            Cancel
        </button>
        <button class="cpb-dialog-button button-requestroll" data-button="roll">
            <i class="fas fa-dice-d20"></i>
            Request Roll
        </button>
    </div>
</div>

