<div class="blacksmith-pin-config" data-icon-mode="{{iconMode}}">
    <div class="window-note-header">
        <div class="window-note-header-content">
            <div class="window-note-header-title">
                <div class="blacksmith-pin-config-title"><i class="fa-solid fa-location-dot"></i> Configure Pin</div>
            </div>
            <div class="window-note-header-controls">
                <div class="blacksmith-pin-config-toggle-container">
                    <span class="blacksmith-pin-config-toggle-label">Use as Default</span>
                    <div class="blacksmith-pin-config-toggle">
                        <input type="checkbox" id="blacksmith-pin-config-default-toggle" class="blacksmith-pin-config-default">
                        <label for="blacksmith-pin-config-default-toggle" class="blacksmith-pin-config-toggle-slider"></label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="window-note-body">
        <div class="blacksmith-pin-config-section blacksmith-pin-config-design-section">
            <div class="blacksmith-pin-config-section-header"><i class="fa-solid fa-ruler-combined"></i> Pin Design</div>
            <div class="blacksmith-pin-config-section-body">
                <div class="blacksmith-pin-config-design-row">
                    <label class="blacksmith-pin-config-design-field">
                        <span>Width</span>
                        <input type="number" class="blacksmith-input blacksmith-pin-config-width" min="8" step="1" value="{{pinWidth}}">
                    </label>
                    <label class="blacksmith-pin-config-design-field">
                        <span>Height</span>
                        <input type="number" class="blacksmith-input blacksmith-pin-config-height" min="8" step="1" value="{{pinHeight}}">
                    </label>
                </div>
                <label class="blacksmith-pin-config-design-toggle">
                    <input type="checkbox" class="blacksmith-pin-config-lock" {{#if lockProportions}}checked{{/if}}>
                    Constrain proportions
                </label>
                <div class="blacksmith-pin-config-design-row">
                    <label class="blacksmith-pin-config-design-field">
                        <span>Shape</span>
                        <select class="blacksmith-input blacksmith-pin-config-shape">
                            <option value="circle" {{#if (eq pinShape "circle")}}selected{{/if}}>Circle</option>
                            <option value="square" {{#if (eq pinShape "square")}}selected{{/if}}>Square</option>
                            <option value="none" {{#if (eq pinShape "none")}}selected{{/if}}>None</option>
                        </select>
                    </label>
                    <label class="blacksmith-pin-config-design-field">
                        <span>Background</span>
                        <div class="blacksmith-pin-config-color-row">
                            <input type="text" class="blacksmith-input blacksmith-pin-config-color-text blacksmith-pin-config-fill-text" value="{{pinFill}}">
                            <input type="color" class="blacksmith-pin-config-color-picker blacksmith-pin-config-fill" value="{{pinFill}}">
                        </div>
                    </label>
                </div>
                <div class="blacksmith-pin-config-design-row">
                    <label class="blacksmith-pin-config-design-field">
                        <span>Border</span>
                        <div class="blacksmith-pin-config-border-row">
                            <div class="blacksmith-pin-config-color-row">
                                <input type="text" class="blacksmith-input blacksmith-pin-config-color-text blacksmith-pin-config-stroke-text" value="{{pinStroke}}">
                                <input type="color" class="blacksmith-pin-config-color-picker blacksmith-pin-config-stroke" value="{{pinStroke}}">
                            </div>
                            <input type="number" class="blacksmith-input blacksmith-pin-config-stroke-width" min="0" step="1" value="{{pinStrokeWidth}}">
                        </div>
                    </label>
                </div>
                <label class="blacksmith-pin-config-design-toggle">
                    <input type="checkbox" class="blacksmith-pin-config-shadow" {{#if pinDropShadow}}checked{{/if}}>
                    Drop shadow
                </label>
            </div>
        </div>

        <div class="blacksmith-pin-config-section blacksmith-pin-config-text-section">
            <div class="blacksmith-pin-config-section-header"><i class="fa-solid fa-font"></i> Text Format</div>
            <div class="blacksmith-pin-config-section-body">
                <div class="blacksmith-pin-config-design-row">
                    <label class="blacksmith-pin-config-design-field">
                        <span>Text layout</span>
                        <select class="blacksmith-input blacksmith-pin-config-text-layout">
                            <option value="under" {{#if (eq pinTextLayout "under")}}selected{{/if}}>Under</option>
                            <option value="over" {{#if (eq pinTextLayout "over")}}selected{{/if}}>Over</option>
                            <option value="around" {{#if (eq pinTextLayout "around")}}selected{{/if}}>Around</option>
                        </select>
                    </label>
                    <label class="blacksmith-pin-config-design-field">
                        <span>Text display</span>
                        <select class="blacksmith-input blacksmith-pin-config-text-display">
                            <option value="always" {{#if (eq pinTextDisplay "always")}}selected{{/if}}>Always</option>
                            <option value="hover" {{#if (eq pinTextDisplay "hover")}}selected{{/if}}>Hover</option>
                            <option value="never" {{#if (eq pinTextDisplay "never")}}selected{{/if}}>Never</option>
                            <option value="gm" {{#if (eq pinTextDisplay "gm")}}selected{{/if}}>GM only</option>
                        </select>
                    </label>
                </div>
                <div class="blacksmith-pin-config-design-row">
                    <label class="blacksmith-pin-config-design-field">
                        <span>Text color</span>
                        <div class="blacksmith-pin-config-color-row">
                            <input type="text" class="blacksmith-input blacksmith-pin-config-color-text blacksmith-pin-config-text-color-text" value="{{pinTextColor}}">
                            <input type="color" class="blacksmith-pin-config-color-picker blacksmith-pin-config-text-color" value="{{pinTextColor}}">
                        </div>
                    </label>
                    <label class="blacksmith-pin-config-design-field">
                        <span>Text size</span>
                        <input type="number" class="blacksmith-input blacksmith-pin-config-text-size" min="6" step="1" value="{{pinTextSize}}">
                    </label>
                </div>
                <div class="blacksmith-pin-config-design-row">
                    <label class="blacksmith-pin-config-design-field">
                        <span>Max length</span>
                        <input type="number" class="blacksmith-input blacksmith-pin-config-text-max-length" min="0" step="1" value="{{pinTextMaxLength}}">
                    </label>
                </div>
                <label class="blacksmith-pin-config-design-toggle">
                    <input type="checkbox" class="blacksmith-pin-config-text-scale" {{#if pinTextScaleWithPin}}checked{{/if}}>
                    Scale text with pin
                </label>
            </div>
        </div>

        <div class="blacksmith-pin-config-source-toggle">
            <span class="blacksmith-pin-config-source-label">Image</span>
            <div class="blacksmith-pin-config-source-switch">
                <input type="checkbox" id="blacksmith-pin-config-source-toggle" class="blacksmith-pin-config-source-toggle-input" {{#if (eq iconMode 'icon')}}checked{{/if}}>
                <label for="blacksmith-pin-config-source-toggle" class="blacksmith-pin-config-source-toggle-slider"></label>
            </div>
            <span class="blacksmith-pin-config-source-label">Icon</span>
        </div>

        <div class="blacksmith-pin-config-section blacksmith-pin-config-image-section">
            <div class="blacksmith-pin-config-section-header"><i class="fa-solid fa-image"></i> Image URL</div>
            <div class="blacksmith-pin-config-section-body">
                <div class="blacksmith-pin-config-image-row">
                    <input type="text" class="blacksmith-input blacksmith-pin-config-image-input" placeholder="Paste image URL..." value="{{imageValue}}">
                    <button type="button" class="btn-secondary blacksmith-pin-config-browse"><i class="fa-solid fa-folder-open"></i> Browse</button>
                </div>
                <div class="blacksmith-pin-config-image-preview-wrap">
                    <img class="blacksmith-pin-config-image-preview {{#unless imageValue}}is-hidden{{/unless}}" src="{{imageValue}}" alt="Pin preview">
                </div>
            </div>
        </div>

        <div class="blacksmith-pin-config-section blacksmith-pin-config-library-section">
            <div class="blacksmith-pin-config-section-header"><i class="fa-solid fa-icons"></i> Icon Library</div>
            <div class="blacksmith-pin-config-section-body">
                {{#each iconCategories}}
                <div class="blacksmith-pin-config-icon-category">
                    <div class="blacksmith-pin-config-icon-category-title">{{this.category}}</div>
                    {{#if this.description}}
                        <div class="blacksmith-pin-config-icon-category-description">{{this.description}}</div>
                    {{/if}}
                    <div class="blacksmith-pin-config-icon-grid">
                        {{#each this.icons}}
                        <button type="button" class="blacksmith-pin-config-icon-option {{#if this.isSelected}}selected{{/if}}" data-type="fa" data-value="{{this.value}}" title="{{this.label}}">
                            <i class="{{this.value}}"></i>
                        </button>
                        {{/each}}
                    </div>
                </div>
                {{/each}}
            </div>
        </div>
    </div>

    <div class="form-actions">
        <button type="button" class="btn-secondary cancel">
            <i class="fa-solid fa-times"></i> Cancel
        </button>
        <button type="button" class="btn-primary blacksmith-pin-config-save">
            <i class="fa-solid fa-check"></i> Save pin design
        </button>
    </div>
</div>
