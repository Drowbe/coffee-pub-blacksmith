<div class="skill-check-dialog">
    <div class="cpb-dialog-content">
        <!-- Left Column -->
        <div class="cpb-dialog-column">
            <h2>1. CHOOSE CONTESTANTS</h2>
            <h3>Left-click to select. Right-click if a Defender.</h3>
            <div class="cpb-form-group">
                <div class="cpb-form-fields cpb-search-container">
                    <input type="text" name="search" placeholder="Search Actors...">
                    <button type="button" class="cpb-clear-search-button" title="Clear search">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="cpb-filter-buttons">
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'party')}}active{{/if}}" data-filter="party">
                    <i class="fas fa-helmet-battle"></i> Party
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'monster')}}active{{/if}}" data-filter="monster">
                    <i class="fas fa-dragon"></i> NPCs
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'canvas')}}active{{/if}}" data-filter="canvas">
                    <i class="fas fa-user-group-crown"></i> Canvas
                </button>
                <button type="button" class="cpb-filter-btn {{#if (eq initialFilter 'selected')}}active{{/if}}" data-filter="selected">
                    <i class="fas fa-square-dashed"></i> Selected
                </button>
            </div>
            <div class="cpb-actor-list">
                {{#each actors}}
                    <div class="cpb-actor-item" data-actor-id="{{this.id}}">
                        <img src="{{this.actor.img}}" alt="{{this.name}}">
                        <div class="cpb-actor-details">
                            <div class="cpb-actor-name">{{this.name}}</div>
                            {{#if (eq this.type "character")}}
                                <div class="cpb-actor-info">Level {{this.level}} {{this.class}}</div>
                            {{else}}
                                <div class="cpb-actor-info">{{this.type}}</div>
                            {{/if}}
                            <div class="cpb-actor-info">HP: {{this.hp.value}}/{{this.hp.max}}</div>
                        </div>
                        <div class="cpb-group-indicator"></div>
                    </div>
                {{/each}}
            </div>
        </div>

        <!-- Middle Column -->
        <div class="cpb-dialog-column">
            <h2>2. SET ROLL TYPE</h2>
            <h3>Right-click to set a different defender type.</h3>
            <div class="cpb-form-group">
                <div class="cpb-form-fields cpb-search-container">
                    <input type="text" name="search" placeholder="Search...">
                    <button type="button" class="cpb-clear-search-button" title="Clear search">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            
            <div class="cpb-checks-list">
                <!-- Dice Roll Section -->
                <div class="cpb-check-section">
                    <div class="cpb-section-header" style="margin-bottom: 8px;">Quick Roll</div>
                    <div class="cpb-dice-grid">
                        <div class="cpb-check-item" data-type="dice" data-value="d2">
                            <i class="fas fa-coin" title="d2"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d4">
                            <i class="fas fa-dice-d4" title="d4"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d6">
                            <i class="fas fa-dice-d6" title="d6"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d8">
                            <i class="fas fa-dice-d8" title="d8"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                    </div>
                    <div class="cpb-dice-grid">
                        <div class="cpb-check-item" data-type="dice" data-value="d10">
                            <i class="fas fa-dice-d10" title="d10"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d12">
                            <i class="fas fa-dice-d12" title="d12"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d20">
                            <i class="fas fa-dice-d20" title="d20"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                        <div class="cpb-check-item" data-type="dice" data-value="d100">
                            <i class="fas fa-hundred-points" title="d100"></i>
                            <div class="cpb-roll-type-indicator"></div>
                        </div>
                    </div>
                </div>

                <!-- Skill Check Section -->
                <div class="cpb-check-section">
                    <div class="cpb-section-header">Skill Check</div>
                    {{#each skills}}
                    <div class="cpb-check-item" data-type="skill" data-value="{{this.id}}">
                        <i class="{{this.icon}}"></i>
                        <span>{{this.name}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>

                <!-- Ability Check Section -->
                <div class="cpb-check-section">
                    <div class="cpb-section-header">Ability Check</div>
                    {{#each abilities}}
                    <div class="cpb-check-item" data-type="ability" data-value="{{this.id}}">
                        <i class="fas fa-user-circle"></i>
                        <span>{{this.name}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>

                <!-- Saving Throw Section -->
                <div class="cpb-check-section">
                    <div class="cpb-section-header">Saving Throw</div>
                    {{#each saves}}
                    <div class="cpb-check-item" data-type="save" data-value="{{this.id}}">
                        <i class="fas fa-shield-alt"></i>
                        <span>{{this.name}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>

                <!-- Tool Check Section -->
                <div class="cpb-check-section">
                    <div class="cpb-section-header">Tool Check</div>
                    {{#each tools}}
                    <div class="cpb-check-item" data-type="tool" data-value="{{this.id}}">
                        <i class="fas fa-tools"></i>
                        <span>{{this.name}}</span>
                        <div class="cpb-roll-type-indicator"></div>
                    </div>
                    {{/each}}
                </div>
            </div>
        </div>

        <!-- Right Column -->
        <div class="cpb-dialog-column">


            <h2>3. CONFIGURE ROLL</h2>
            <h3>Contested roll overrides group settings.</h3>
            <div class="cpb-form-group">
                <div class="cpb-form-fields">
                    <select name="rollMode">
                        <option value="roll">Public Roll</option>
                        <option value="gmroll">Private Roll</option>
                        <option value="blindroll">GM Only</option>
                    </select>
                </div>
            </div>
            
            <div class="cpb-roll-options-column">

                <div class="cpb-section-header">Dice Check (Optional)</div>

                <div class="cpb-form-group">
                    <label>DC to Beat</label>
                    <div class="cpb-form-fields">
                        <input type="number" name="dc" placeholder="DC">
                    </div>
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="showDC" checked> Show the DC to the players
                        </label>
                    </div>
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="groupRoll" checked> Evaluate Group DC
                        </label>
                    </div>
                </div>

                <div class="cpb-section-header">Additional Context</div>

                <div class="cpb-form-group">
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="showRollExplanation" checked> Show Roll Explanation
                        </label>
                    </div>
                    <div class="cpb-form-fields">
                        <label class="cpb-checkbox">
                            <input type="checkbox" name="showRollExplanationLink" checked> Show Link to SRD
                        </label>
                    </div>
                </div>

                <div class="cpb-section-header">Custom Roll Message (Optional)</div>

                <div class="cpb-form-group">
                    <label>Roll Title</label>
                    <div class="cpb-form-fields">
                        <input type="text" name="label" placeholder="Roll label">
                    </div>
                </div>
                <div class="cpb-form-group">
                    <label>Roll Narrative</label>
                    <div class="cpb-form-fields">
                        <textarea name="description" rows="4" placeholder="Optional description..."></textarea>
                    </div>
                </div>

            </div>

        </div>
    </div>
    <!-- BUTTONS -->
    <div class="cpb-dialog-buttons">
        <button class="cpb-dialog-button" data-button="roll">
            <i class="fas fa-dice-d20"></i>
            Request Roll
        </button>
        <button class="cpb-dialog-button" data-button="cancel">
            <i class="fas fa-times"></i>
            Cancel
        </button>
    </div>
</div>

